var jobs = require('./../routes/jobs'),
    http = require('http');
exports.testList = function (test) {
    var query = 'engineer';
    var req = http.get('http://localhost:8080/jobs?filter=' + query, function (res) {
        var pageData = "";
        res.setEncoding('utf8');
        res.on('data', function (chunk) {
            pageData += chunk;
        });
        res.on('end', function () {
            try {
                var  result =  JSON.parse(pageData.toString());
            }
            catch (error) {
                res.statusCode = 500;
                console.log("the server have unstable data");
            }
            if ((result && result.jobs) && Array.isArray(result.jobs)) {
                result.jobs.forEach(function (element, index) {
                    test.ok(element.title.toLowerCase().indexOf(query) > -1 || element.description.toLowerCase().indexOf(query) > -1, "the result have no mach at: " + index);
                });
            }
            test.done();
        });
    }).on('error', function (e) {
            test.ok(false, "there is no data from service or the server is down or unreachable");
            test.done();
            console.error("Got error: " + e.message);
        });
}
